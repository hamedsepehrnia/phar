{% extends 'base_minimal.html' %}

{% block title %}Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ - Ø¯Ø§Ø±ÙˆØ®Ø§Ù†Ù‡ Ø¯Ú©ØªØ± ÙˆØ§Ø¹Ø¸ÛŒ{% endblock %}

{% block content %}
<h1 class="section-title">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</h1>

{% if cart.items.count > 0 %}
<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
  <!-- Cart Items -->
  <div>
    {% for item in cart.items.all %}
    <div class="card" style="display: flex; gap: 20px; margin-bottom: 15px;">
      {% if item.product.primary_image %}
      <img src="{{ item.product.primary_image.url }}" alt="{{ item.product.name }}" style="width: 100px; height: 100px; object-fit: contain;">
      {% else %}
      <div style="width: 100px; height: 100px; background: #eee; display: flex; align-items: center; justify-content: center;">ğŸ“¦</div>
      {% endif %}
      
      <div style="flex: 1;">
        <h3 style="margin-bottom: 10px;">{{ item.product.name }}</h3>
        <p style="color: #666; margin-bottom: 5px;">Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯: {{ item.product.price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</p>
        
        <form method="post" action="/cart/update/{{ item.id }}/" style="display: inline-flex; gap: 10px; align-items: center;">
          {% csrf_token %}
          <label>ØªØ¹Ø¯Ø§Ø¯:</label>
          <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.product.stock }}" 
                 style="width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 3px; text-align: center;">
          <button type="submit" class="btn" style="padding: 5px 15px; font-size: 12px;">Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ</button>
        </form>
        
        <form method="post" action="/cart/remove/{{ item.id }}/" style="display: inline;">
          {% csrf_token %}
          <button type="submit" style="background: #fee2e2; color: #991b1b; border: none; padding: 5px 15px; border-radius: 5px; cursor: pointer;">Ø­Ø°Ù</button>
        </form>
      </div>
      
      <div style="text-align: left; min-width: 120px;">
        <p style="font-weight: bold; color: #0ea5e9; font-size: 1.1em;">{{ item.total_price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</p>
      </div>
    </div>
    {% endfor %}
  </div>
  
  <!-- Cart Summary -->
  <div>
    <div class="card" style="position: sticky; top: 20px;">
      <h3 style="margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee;">Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´</h3>
      
      <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
        <span>ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ù„Ø§Ù‡Ø§:</span>
        <span>{{ cart.total_items }} Ø¹Ø¯Ø¯</span>
      </div>
      
      <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
        <span>Ø¬Ù…Ø¹ Ú©Ù„:</span>
        <span>{{ cart.total_price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</span>
      </div>
      
      {% if cart.discount_amount %}
      <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: #22c55e;">
        <span>ØªØ®ÙÛŒÙ:</span>
        <span>{{ cart.discount_amount|floatformat:0 }}- ØªÙˆÙ…Ø§Ù†</span>
      </div>
      {% endif %}
      
      <hr style="margin: 15px 0; border: none; border-top: 1px solid #eee;">
      
      <div style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 1.2em; font-weight: bold;">
        <span>Ù…Ø¨Ù„Øº Ù‚Ø§Ø¨Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª:</span>
        <span style="color: #0ea5e9;">{{ cart.final_price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</span>
      </div>
      
      <!-- Coupon -->
      <form method="post" action="/cart/coupon/" style="margin-bottom: 20px;">
        {% csrf_token %}
        <div style="display: flex; gap: 10px;">
          <input type="text" name="code" placeholder="Ú©Ø¯ ØªØ®ÙÛŒÙ" 
                 style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
          <button type="submit" class="btn" style="padding: 10px 15px;">Ø§Ø¹Ù…Ø§Ù„</button>
        </div>
      </form>
      
      <a href="/checkout/" class="btn" style="display: block; text-align: center; padding: 15px;">Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯</a>
    </div>
  </div>
</div>

<style>
  @media (max-width: 768px) {
    div[style*="grid-template-columns: 2fr 1fr"] {
      grid-template-columns: 1fr !important;
    }
  }
</style>

{% else %}
<div class="card" style="text-align: center; padding: 50px;">
  <div style="font-size: 80px; margin-bottom: 20px;">ğŸ›’</div>
  <h2>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª</h2>
  <p style="color: #666; margin: 20px 0;">Ù‡Ù†ÙˆØ² Ù…Ø­ØµÙˆÙ„ÛŒ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯</p>
  <a href="/shop/" class="btn">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª</a>
</div>
{% endif %}
{% endblock %}
